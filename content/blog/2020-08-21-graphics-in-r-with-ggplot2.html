---
title: Graphics in R with ggplot2
author: Antoine Soetewey
date: '2020-08-21'
slug: graphics-in-r-with-ggplot2
categories: []
tags:
  - Descriptive statistics
  - R
  - Package
  - Visualization
meta_img: blog/2020-08-21-graphics-in-r-with-ggplot2_files/graphics-in-r-with-ggplot2.png
description: Learn how to create professional graphics and plots in R (histogram, barplot, boxplot, scatter plot, line plot, density plot, etc.) with the ggplot2 package
output:
  blogdown::html_page:
    toc: true
    toc_depth: 6
# draft: true
# bibliography: bibliography.bib
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#basic-principles-of-ggplot2">Basic principles of <code>{ggplot2}</code></a></li>
<li><a href="#create-plots-with-ggplot2">Create plots with <code>{ggplot2}</code></a>
<ul>
<li><a href="#scatter-plot">Scatter plot</a></li>
<li><a href="#line-plot">Line plot</a></li>
<li><a href="#combination-of-line-and-points">Combination of line and points</a></li>
<li><a href="#histogram">Histogram</a></li>
<li><a href="#density-plot">Density plot</a></li>
<li><a href="#combination-of-histogram-and-densities">Combination of histogram and densities</a></li>
<li><a href="#boxplot">Boxplot</a></li>
<li><a href="#barplot">Barplot</a></li>
<li><a href="#further-personalization">Further personalization</a>
<ul>
<li><a href="#title-and-axis-labels">Title and axis labels</a></li>
<li><a href="#axis-ticks">Axis ticks</a></li>
<li><a href="#log-transformations">Log transformations</a></li>
<li><a href="#limits">Limits</a></li>
<li><a href="#scales-for-better-axis-formats">Scales for better axis formats</a></li>
<li><a href="#legend">Legend</a></li>
<li><a href="#shape-color-size-and-transparency">Shape, color, size and transparency</a></li>
<li><a href="#text-and-labels">Text and labels</a></li>
<li><a href="#smooth-and-regression-lines">Smooth and regression lines</a></li>
<li><a href="#facets">Facets</a></li>
<li><a href="#themes">Themes</a></li>
<li><a href="#interactive-plot-with-plotly">Interactive plot with <code>{plotly}</code></a></li>
<li><a href="#combine-plots-with-patchwork">Combine plots with <code>{patchwork}</code></a></li>
<li><a href="#flip-coordinates">Flip coordinates</a></li>
<li><a href="#save-plot">Save plot</a></li>
<li><a href="#managing-dates">Managing dates</a></li>
</ul></li>
</ul></li>
<li><a href="#tip">Tip</a></li>
<li><a href="#to-go-further">To go further</a></li>
</ul>
</div>

<center>
<img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/graphics-in-r-with-ggplot2.png" style="width:50.0%" />
</center>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>R is known to be a really powerful programming language when it comes to graphics and visualizations (in addition to <a href="/tags/statistics/">statistics</a> and data science of course!).</p>
<p>To keep it short, graphics in R can be done in three ways, via the:</p>
<ol style="list-style-type: decimal">
<li><code>{graphics}</code> package (the base graphics in R, loaded by default)</li>
<li><code>{lattice}</code> package which adds more functionalities to the base package</li>
<li><code>{ggplot2}</code> package (which needs to be <a href="/blog/an-efficient-way-to-install-and-load-r-packages/">installed and loaded</a> beforehand)</li>
</ol>
<p>The <code>{graphics}</code> package comes with a large choice of plots (such as <code>plot</code>, <code>hist</code>, <code>barplot</code>, <code>boxplot</code>, <code>pie</code>, <code>mosaicplot</code>, etc.) and additional related features (e.g., <code>abline</code>, <code>lines</code>, <code>legend</code>, <code>mtext</code>, <code>rect</code>, etc.). It is often the preferred way to draw plots for most R users, and in particular for beginners to intermediate users.</p>
<p>Since its creation in 2005 by Hadley Wickham, <strong><code>{ggplot2}</code></strong> has grown in use to become one of the most popular R packages and the <strong>most popular package for graphics and data visualizations</strong>. The <code>{ggplot2}</code> package is a much more modern approach to creating professional-quality graphics. More information about the package can be found at <a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2.tidyverse.org</a>.</p>
<p>In this article, we will see how to create common plots such as scatter plots, line plots, histograms, boxplots, barplots, density plots in R with this package. If you are unfamiliar with any of these types of graph, you will find more information about each one (when to use it, its purpose, what does it show, etc.) in my article about <a href="/blog/descriptive-statistics-in-r/">descriptive statistics in R</a>.</p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>To illustrate plots with the <code>{ggplot2}</code> package we will use the <code>mpg</code> dataset available in the package. The dataset contains observations collected by the US Environmental Protection Agency on fuel economy from 1999 to 2008 for 38 popular models of cars (run <code>?mpg</code> for more information about the data):</p>
<pre class="r"><code>library(ggplot2)
dat &lt;- ggplot2::mpg</code></pre>
<p>Before going further, let’s transform the <code>cyl</code>, <code>drv</code>, <code>fl</code>, <code>year</code> and <code>class</code> variables in <a href="/blog/data-types-in-r/#factor">factor</a> with the <code>transform()</code> function:</p>
<pre class="r"><code>dat &lt;- transform(dat,
  cyl = factor(cyl),
  drv = factor(drv),
  fl = factor(fl),
  year = factor(year),
  class = factor(class)
)</code></pre>
<p>For the interested reader, see more <a href="/blog/data-manipulation-in-r/">data manipulation techniques in R</a>.</p>
</div>
<div id="basic-principles-of-ggplot2" class="section level1">
<h1>Basic principles of <code>{ggplot2}</code></h1>
<p>The <code>{ggplot2}</code> package is based on the principles of “The Grammar of Graphics” (hence “gg” in the name of <code>{ggplot2}</code>), that is, a coherent system for describing and building graphs. The main idea is to <strong>design a graphic as a succession of layers</strong>.</p>
<p>The main layers are:</p>
<ol style="list-style-type: decimal">
<li>The <strong>dataset</strong> that contains the variables that we want to represent. This is done with the <code>ggplot()</code> function and comes first.</li>
<li>The <strong>variable(s)</strong> to represent on the x and/or y-axis, and the aesthetic elements (such as color, size, fill, shape and transparency) of the objects to be represented. This is done with the <code>aes()</code> function (abbreviation of aesthetic).</li>
<li>The <strong>type of graphical representation</strong> (scatter plot, line plot, barplot, histogram, boxplot, etc.). This is done with the functions <code>geom_point()</code>, <code>geom_line()</code>, <code>geom_bar()</code>, <code>geom_histogram()</code>, <code>geom_boxplot()</code>, etc.</li>
<li>If needed, additional layers (such as labels, annotations, scales, axis ticks, legends, themes, facets, etc.) can be added to personalize the plot.</li>
</ol>
<p>To create a plot, we thus first need to specify the data in the <code>ggplot()</code> function and then add the required layers such as the variables, the aesthetic elements and the type of plot:</p>
<pre class="r"><code>ggplot(data) +
  aes(x = var_x, y = var_y) +
  geom_x()</code></pre>
<ul>
<li><code>data</code> in <code>ggplot()</code> is the name of the data frame which contains the variables <code>var_x</code> and <code>var_y</code>.</li>
<li>The <code>+</code> symbol is used to indicate the different layers that will be added to the plot. Make sure to write the <code>+</code> <em>symbol at the end of the line</em> of code and not at the beginning of the line, otherwise R throws an error.</li>
<li>The layer <code>aes()</code> indicates what variables will be used in the plot and more generally, the aesthetic elements of the plot.</li>
<li>Finally, <code>x</code> in <code>geom_x()</code> represents the type of plot.</li>
<li>Other layers are usually not required unless we want to personalize the plot further.</li>
</ul>
<p>Note that it is a good practice to write one line of code per layer to improve code readability.</p>
</div>
<div id="create-plots-with-ggplot2" class="section level1">
<h1>Create plots with <code>{ggplot2}</code></h1>
<p>In the following sections we will show how to draw the following plots:</p>
<ul>
<li>scatter plot</li>
<li>line plot</li>
<li>histogram</li>
<li>density plot</li>
<li>boxplot</li>
<li>barplot</li>
</ul>
<p>In order to focus on the construction of the different plots and the use of <code>{ggplot2}</code>, we will restrict ourselves to drawing basic (yet beautiful) plots without unnecessary layers. For the sake of completeness, we will briefly discuss and illustrate different layers to further personalize a plot at the end of the article (see this <a href="/blog/graphics-in-r-with-ggplot2/#further-personalization">section</a>).</p>
<p>Note that if you still struggle to create plots with <code>{ggplot2}</code> after reading this tutorial, you may find the <a href="/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/#esquisse">{esquisse} addin</a> useful. This addin allows you to <strong>interactively</strong> (that is, by dragging and dropping variables) create plots with the <code>{ggplot2}</code> package. Give it a try!</p>
<div id="scatter-plot" class="section level2">
<h2>Scatter plot</h2>
<p>We start by creating a <a href="/blog/descriptive-statistics-in-r/#scatterplot">scatter plot</a> using <code>geom_point</code>. Remember that a scatter plot is used to visualize the relation between two <a href="/blog/variable-types-and-examples/#quantitative">quantitative variables</a>.</p>
<ol style="list-style-type: decimal">
<li>We start by specifying the data:</li>
</ol>
<pre class="r"><code>ggplot(dat) # data</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Then we add the variables to be represented with the <code>aes()</code> function:</li>
</ol>
<pre class="r"><code>ggplot(dat) + # data
  aes(x = displ, y = hwy) # variables</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Finally, we indicate the type of plot:</li>
</ol>
<pre class="r"><code>ggplot(dat) + # data
  aes(x = displ, y = hwy) + # variables
  geom_point() # type of plot</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>You will also sometimes see the aesthetic elements (<code>aes()</code> with the variables) inside the <code>ggplot()</code> function in addition to the dataset:</p>
<pre class="r"><code>ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>This second method gives the exact same plot than the first method. I tend to prefer the first method over the second for better readability, but this is more a matter of taste so the choice is up to you.</p>
</div>
<div id="line-plot" class="section level2">
<h2>Line plot</h2>
<p><a href="/blog/descriptive-statistics-in-r/#line-plot">Line plots</a>, particularly useful in time series or finance, can be created similarly but by using <code>geom_line()</code>:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_line()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="combination-of-line-and-points" class="section level2">
<h2>Combination of line and points</h2>
<p>An advantage of <code>{ggplot2}</code> is the ability to combine several types of plots and its flexibility in designing it. For instance, we can add a line to a scatter plot by simply adding a layer to the initial scatter plot:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_point() +
  geom_line() # add line</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="histogram" class="section level2">
<h2>Histogram</h2>
<p>A <a href="/blog/descriptive-statistics-in-r/#histogram">histogram</a> (useful to visualize distributions and detect potential <a href="/blog/outliers-detection-in-r/">outliers</a>) can be plotted using <code>geom_histogram()</code>:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = hwy) +
  geom_histogram()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>By default, the number of bins is equal to 30. You can change this value using the <code>bins</code> argument inside the <code>geom_histogram()</code> function:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = hwy) +
  geom_histogram(bins = sqrt(nrow(dat)))</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Here I specify the number of bins to be equal to the square root of the number of observations (following Sturge’s rule) but you can specify any numeric value.</p>
</div>
<div id="density-plot" class="section level2">
<h2>Density plot</h2>
<p><a href="/blog/descriptive-statistics-in-r/#density-plot">Density plots</a> can be created using <code>geom_density()</code>:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = hwy) +
  geom_density()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="combination-of-histogram-and-densities" class="section level2">
<h2>Combination of histogram and densities</h2>
<p>We can also superimpose a histogram and a density curve on the same plot:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = hwy, y = ..density..) +
  geom_histogram() +
  geom_density()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Or superimpose several densities:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = hwy, color = drv, fill = drv) +
  geom_density(alpha = 0.25) # add transparency</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The argument <code>alpha = 0.25</code> has been added for some transparency. More information about this argument can be found in this <a href="/blog/graphics-in-r-with-ggplot2/#further-personalization">section</a>.</p>
</div>
<div id="boxplot" class="section level2">
<h2>Boxplot</h2>
<p>A <a href="/blog/descriptive-statistics-in-r/#boxplot">boxplot</a> (also very useful to visualize distributions and detect potential <a href="/blog/outliers-detection-in-r/">outliers</a>) can be plotted using <code>geom_boxplot()</code>:</p>
<pre class="r"><code># Boxplot for one variable
ggplot(dat) +
  aes(x = &quot;&quot;, y = hwy) +
  geom_boxplot()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Boxplot by factor
ggplot(dat) +
  aes(x = drv, y = hwy) +
  geom_boxplot()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-15-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>It is also possible to plot the points on the boxplot with <code>geom_jitter()</code>, and to vary the width of the boxes according to the size (i.e., the number of observations) of each level with <code>varwidth = TRUE</code>:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv, y = hwy) +
  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.
  geom_jitter(alpha = 0.25, width = 0.2) # adds random noise and limit its width</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The <code>geom_jitter()</code> layer adds some random variation to each point in order to prevent them from overlapping (an issue known as overplotting).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Moreover, the <code>alpha</code> argument adds some transparency to the points (see more in this <a href="/blog/graphics-in-r-with-ggplot2/#further-personalization">section</a>) to keep the focus on the boxes and not on the points.</p>
<p>Finally, it is also possible to divide boxplots into several panels according to the levels of a <a href="/blog/variable-types-and-examples/#qualitative">qualitative variable</a>:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv, y = hwy) +
  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.
  geom_jitter(alpha = 0.25, width = 0.2) + # adds random noise and limit its width
  facet_wrap(~year) # divide into 2 panels</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>For a visually more appealing plot, it is also possible to use some colors for the boxes depending on the x variable:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv, y = hwy, fill = drv) + # add color to boxes with fill
  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.
  geom_jitter(alpha = 0.25, width = 0.2) + # adds random noise and limit its width
  facet_wrap(~year) + # divide into 2 panels
  theme(legend.position = &quot;none&quot;) # remove legend</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>In that case, it best to remove the legend as it becomes redundant. See more information about the legend in this <a href="/blog/graphics-in-r-with-ggplot2/#legend">section</a>.</p>
<p>If you are unhappy with the default colors provided in <code>{ggplot2}</code>, you can change them manually with the <code>scale_fill_manual()</code> layer:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv, y = hwy, fill = drv) + # add color to boxes with fill
  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.
  geom_jitter(alpha = 0.25, width = 0.2) + # adds random noise and limit its width
  facet_wrap(~year) + # divide into 2 panels
  theme(legend.position = &quot;none&quot;) + # remove legend
  scale_fill_manual(values = c(&quot;darkred&quot;, &quot;darkgreen&quot;, &quot;steelblue&quot;)) # change fill color manually</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="barplot" class="section level2">
<h2>Barplot</h2>
<p>A <a href="/blog/descriptive-statistics-in-r/#barplot">barplot</a> (useful to visualize qualitative variables) can be plotted using <code>geom_bar()</code>:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv) +
  geom_bar()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>By default, the heights of the bars correspond to the observed frequencies for each level of the variable of interest (<code>drv</code> in our case).</p>
<p>Again, for a more appealing plot, we can add some colors to the bars with the <code>fill</code> argument:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv, fill = drv) + # add colors to bars
  geom_bar() +
  theme(legend.position = &quot;none&quot;) # remove legend</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We can also create a barplot with two qualitative variables:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = drv, fill = year) + # fill by years
  geom_bar()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>In order to compare proportions across groups, it is best to make each bar the same height using <code>position = "fill"</code>:</p>
<pre class="r"><code>ggplot(dat) +
  geom_bar(aes(x = drv, fill = year), position = &quot;fill&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>To draw the bars next to each other for each group, use <code>position = "dodge"</code>:</p>
<pre class="r"><code>ggplot(dat) +
  geom_bar(aes(x = drv, fill = year), position = &quot;dodge&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="further-personalization" class="section level2">
<h2>Further personalization</h2>
<div id="title-and-axis-labels" class="section level3">
<h3>Title and axis labels</h3>
<p>The first things to personalize in a plot is the labels to make the plot more informative to the audience. We can easily add a title, subtitle, caption and edit axis labels with the <code>labs()</code> function:</p>
<pre class="r"><code>p &lt;- ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_point()

p + labs(
  title = &quot;Fuel efficiency for 38 popular models of car&quot;,
  subtitle = &quot;Period 1999-2008&quot;,
  caption = &quot;Data: ggplot2::mpg. See more at statsandr.com&quot;,
  x = &quot;Engine displacement (litres)&quot;,
  y = &quot;Highway miles per gallon (mpg)&quot;
)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>As you can see in the above code, you can save one or more layers of the plot in an object for later use. This way, you can save your “main” plot, and add more layers of personalization until you get the desired output. Here we saved the main scatter plot in an object called <code>p</code> and we will refer to it for the subsequent personalizations.</p>
<p>You can also edit the alignment, the size and the shape of the title and subtitle via the <code>theme()</code> layer and the <code>element_text()</code> function:</p>
<pre class="r"><code>p + labs(
  title = &quot;Fuel efficiency for 38 popular models of car&quot;,
  subtitle = &quot;Period 1999-2008&quot;,
  caption = &quot;Data: ggplot2::mpg. See more at statsandr.com&quot;,
  x = &quot;Engine displacement (litres)&quot;,
  y = &quot;Highway miles per gallon (mpg)&quot;
) +
  theme(
    plot.title = element_text(
      hjust = 0.5, # center
      size = 12,
      color = &quot;steelblue&quot;,
      face = &quot;bold&quot;
    ),
    plot.subtitle = element_text(
      hjust = 0.5, # center
      size = 10,
      color = &quot;gray&quot;,
      face = &quot;italic&quot;
    )
  )</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>If the title or subtitle is long and you want to divide it into multiple lines, use <code>\n</code>:</p>
<pre class="r"><code>p + labs(
  title = &quot;Fuel efficiency for 38 popular \n models of car&quot;,
  subtitle = &quot;Period 1999-2008&quot;,
  caption = &quot;Data: ggplot2::mpg. See more at statsandr.com&quot;,
  x = &quot;Engine displacement (litres)&quot;,
  y = &quot;Highway miles per gallon (mpg)&quot;
) +
  theme(
    plot.title = element_text(
      hjust = 0.5, # center
      size = 12,
      color = &quot;steelblue&quot;,
      face = &quot;bold&quot;
    ),
    plot.subtitle = element_text(
      hjust = 0.5, # center
      size = 10,
      color = &quot;gray&quot;,
      face = &quot;italic&quot;
    )
  )</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="axis-ticks" class="section level3">
<h3>Axis ticks</h3>
<p>Axis ticks can be adjusted using <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> for the x and y-axis, respectively:</p>
<pre class="r"><code># Adjust ticks
p + scale_x_continuous(breaks = seq(from = 1, to = 7, by = 0.5)) + # x-axis
  scale_y_continuous(breaks = seq(from = 10, to = 45, by = 5)) # y-axis</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="log-transformations" class="section level3">
<h3>Log transformations</h3>
<p>In some cases, it is useful to plot the log transformation of the variables. This can be done with the <code>scale_x_log10()</code> and <code>scale_y_log10()</code> functions:</p>
<pre class="r"><code>p + scale_x_log10() +
  scale_y_log10()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="limits" class="section level3">
<h3>Limits</h3>
<p>The most convenient way to control the limits of the plot is to use again the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions in addition to the <code>limits</code> argument:</p>
<pre class="r"><code>p + scale_x_continuous(limits = c(3, 6)) +
  scale_y_continuous(limits = c(20, 30))</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>It is also possible to simply take a subset of the dataset with the <code>subset()</code> or <code>filter()</code> function. See how to <a href="/blog/data-manipulation-in-r/#subset-a-data-frame">subset a dataset</a> if you need a reminder.</p>
</div>
<div id="scales-for-better-axis-formats" class="section level3">
<h3>Scales for better axis formats</h3>
<p>Depending on your data, it is possible to format axes in a certain way with the <code>{scales}</code> package. The formats I use the most are <code>comma</code> and <code>label_number_si()</code> which format large numbers in a more-readable way.</p>
<p>For this example, we multiply both variables by 1000 to have larger numbers and then we apply a different format to each axis:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = displ * 1000, y = hwy * 1000) +
  geom_point() +
  scale_y_continuous(labels = scales::label_number_si()) + # format y-axis
  scale_x_continuous(labels = scales::comma) # format x-axis</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>As you can see, numbers on the y-axis are automatically labeled with the best SI prefix (“K” for values <span class="math inline">\(\ge\)</span> 10e3, “M” for <span class="math inline">\(\ge\)</span> 10e6, “B” for <span class="math inline">\(\ge\)</span> 10e9, and “T” for <span class="math inline">\(\ge\)</span> 10e12) and numbers on the x-axis are displayed as 2,000, 3,000, etc. instead of 2000, 3000, etc.</p>
<p>These two formats make large numbers easier to read. Other formats are possible such as using dollar signs, percentage signs, dates etc. See more information in the <a href="https://scales.r-lib.org/" target="_blank">package’s documentation</a>.</p>
</div>
<div id="legend" class="section level3">
<h3>Legend</h3>
<p>By default, the legend is located to the right side of the plot (when there is a legend to be displayed of course). To control the position of the legend, we need to use the <code>theme()</code> function in addition to the <code>legend.position</code> argument:</p>
<pre class="r"><code>p + aes(color = class) +
  theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-32-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Replace <code>"top"</code> by <code>"left"</code> or <code>"bottom"</code> to change its position and by <code>"none"</code> to remove it.</p>
<p>The title of the legend can be edited with the <code>labs()</code> layer:</p>
<pre class="r"><code>p + aes(color = class) +
  labs(color = &quot;Car&#39;s class&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Note that the argument inside <code>labs()</code> must match the one inside the <code>aes()</code> layer (in this case: <code>color</code>).</p>
<p>The title of the legend can also be removed with <code>legend.title = element_blank()</code> inside the <code>theme()</code> layer:</p>
<pre class="r"><code>p + aes(color = class) +
  theme(
    legend.title = element_blank(),
    legend.position = &quot;bottom&quot;
  )</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The legend now appears at the bottom of the plot, without the legend title.</p>
</div>
<div id="shape-color-size-and-transparency" class="section level3">
<h3>Shape, color, size and transparency</h3>
<p>There are a very large number of options to improve the quality of the plot or to add additional information. These include:</p>
<ul>
<li>shape,</li>
<li>size,</li>
<li>color, and</li>
<li>alpha (transparency).</li>
</ul>
<p>We can for instance change the shape of all points in a scatter plot by adding <code>shape</code> to <code>geom_point()</code>, or vary the shape according to the values taken by another variable (in that case, the <code>shape</code> argument must be inside <code>aes()</code>):<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<pre class="r"><code># Change shape of all points
ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_point(shape = 4)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-35-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change shape of points based on a categorical variable
ggplot(dat) +
  aes(x = displ, y = hwy, shape = drv) +
  geom_point()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-35-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Following the same principle, we can modify the color, size and transparency of the points based on a <a href="/blog/variable-types-and-examples/#qualitative">qualitative</a> or <a href="/blog/variable-types-and-examples/#quantitative">quantitative</a> variable. Here are some examples:</p>
<pre class="r"><code>p &lt;- ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_point()

# Change color for all points
p + geom_point(color = &quot;steelblue&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change color based on a qualitative variable
p + aes(color = drv)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-2.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change color based on a quantitative variable
p + aes(color = cty)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-3.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change color based on a criterion (median of cty variable)
p + aes(color = cty &gt; median(cty))</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-4.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change size of all points
p + geom_point(size = 4)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-5.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change size of points based on a quantitative variable
p + aes(size = cty)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-6.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change transparency based on a quantitative variable
p + aes(alpha = cty)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-7.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We can of course mix several options (shape, color, size, alpha) to build more complex graphics:</p>
<pre class="r"><code>p + geom_point(size = 0.5) +
  aes(color = drv, shape = year, alpha = cty)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>If you are unhappy with the default colors, you can change them manually with the <code>scale_colour_manual()</code> layer (for qualitative variables) and the <code>scale_coulour_gradient2()</code> layer (for quantitative variables):</p>
<pre class="r"><code># Change color based on a qualitative variable
p + aes(color = drv) +
  scale_colour_manual(values = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;))</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-38-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Change color based on a quantitative variable
p + aes(color = cty) +
  scale_colour_gradient2(
    low = &quot;green&quot;,
    mid = &quot;gray&quot;,
    high = &quot;red&quot;,
    midpoint = median(dat$cty)
  )</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-38-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>For your information, you can emulate <code>{ggplot2}</code> default color palette for a desired number of colors and produce a character vector of HEX colors. For example, with 4 colors:</p>
<pre class="r"><code>library(scales)
show_col(hue_pal()(4))</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-39-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="text-and-labels" class="section level3">
<h3>Text and labels</h3>
<p>To add a label on a point (for example the row number), we can use the <code>geom_text()</code> and <code>aes()</code> functions:</p>
<pre class="r"><code>p + geom_text(aes(label = rownames(dat)),
  check_overlap = TRUE,
  size = 2,
  vjust = -1
)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-40-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>To add text on the plot, we use the <code>annotate()</code> function:</p>
<pre class="r"><code>p + annotate(&quot;text&quot;,
  x = 6,
  y = 40,
  label = &quot;hwy and displ are \n negatively correlated \n (rho = -0.77, p-value &lt; 0.001)&quot;,
  size = 3
)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-41-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Read the article on <a href="/blog/correlation-coefficient-and-correlation-test-in-r/">correlation coefficient and correlation test in R</a> to see how I computed the correlation coefficient (rho) and the <em>p</em>-value of the correlation test.</p>
</div>
<div id="smooth-and-regression-lines" class="section level3">
<h3>Smooth and regression lines</h3>
<p>In a scatter plot, it is possible to add a smooth line fitted to the data:</p>
<pre class="r"><code>p + geom_smooth()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>In the context of simple <a href="/blog/multiple-linear-regression-made-simple/">linear regression</a>, it is often the case that the regression line is displayed on the plot. This can be done by adding <code>method = lm</code> (<code>lm</code> stands for linear model) in the <code>geom_smooth()</code> layer:</p>
<pre class="r"><code>p + geom_smooth(method = lm)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>It is also possible to draw a regression line for each level of a categorical variable:</p>
<pre class="r"><code>p + aes(color = drv, shape = drv) +
  geom_smooth(method = lm, se = FALSE)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The <code>se = FALSE</code> argument removes the confidence interval around the regression lines.</p>
</div>
<div id="facets" class="section level3">
<h3>Facets</h3>
<p><code>facet_grid</code> allows you to divide the same graphic into several panels according to the values of one or two qualitative variables:</p>
<pre class="r"><code># According to one variable
p + facet_grid(. ~ drv)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># According to 2 variables
p + facet_grid(drv ~ year)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-45-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>It is then possible to add a regression line to each facet:</p>
<pre class="r"><code>p + facet_grid(. ~ drv) +
  geom_smooth(method = lm)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-46-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><code>facet_wrap()</code> can also be used, as illustrated in this <a href="/blog/graphics-in-r-with-ggplot2/#boxplot">section</a>.</p>
</div>
<div id="themes" class="section level3">
<h3>Themes</h3>
<p>Several functions are available in the <code>{ggplot2}</code> package to change the theme of the plot. The most common themes after the default theme (i.e., <code>theme_gray()</code>) are the black and white (<code>theme_bw()</code>), minimal (<code>theme_minimal()</code>) and classic (<code>theme_classic()</code>) themes:</p>
<pre class="r"><code># Black and white theme
p + theme_bw()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Minimal theme
p + theme_minimal()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-47-2.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Classic theme
p + theme_classic()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-47-3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>I tend to use the minimal theme for most of my <a href="/blog/getting-started-in-r-markdown/">R Markdown</a> reports as it brings out the patterns and points and not the layout of the plot, but again this is a matter of personal taste. See more themes at <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" target="_blank">ggplot2.tidyverse.org/reference/ggtheme.html</a> and in the <code>{ggthemes}</code> package.</p>
<p>In order to avoid having to change the theme for each plot you create, you can change the theme for the current R session using the <code>theme_set()</code> function as follows:</p>
<pre class="r"><code>theme_set(theme_minimal())</code></pre>
</div>
<div id="interactive-plot-with-plotly" class="section level3">
<h3>Interactive plot with <code>{plotly}</code></h3>
<p>You can easily make your plots created with <code>{ggplot2}</code> interactive with the <code>{plotly}</code> package:</p>
<pre class="r"><code>library(plotly)
ggplotly(p + aes(color = year))</code></pre>
<div id="htmlwidget-1" style="width:100%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[1.8,1.8,2.8,2.8,1.8,1.8,2.8,2.8,2.8,5.7,5.7,5.7,5.7,6.5,2.4,3.1,2.4,3,3.3,3.3,3.8,3.8,3.9,3.9,5.2,5.2,3.9,5.2,5.9,5.2,5.2,5.9,4.6,5.4,4,4,4,5,4.2,4.2,4.6,4.6,5.4,3.8,3.8,4.6,4.6,1.6,1.6,1.6,1.6,1.6,2.4,2.4,2.5,2.5,2,2,4,4.7,4,4.6,5.4,5.4,4,5,2.4,2.4,3,3,3.3,3.3,3.1,3.8,3.8,2.5,2.5,2.2,2.2,2.5,2.5,2.7,2.7,3.4,3.4,2.2,2.2,3,3,2.2,2.2,3,3,1.8,1.8,1.8,4.7,2.7,2.7,3.4,3.4,2,2,2.8,1.9,2,2,2.8,2.8,1.9,1.9,2,2,1.8,1.8,2.8,2.8],"y":[29,29,26,26,26,25,25,25,24,17,26,23,15,17,27,26,24,24,22,22,22,21,17,17,17,15,17,16,15,15,16,15,17,17,17,19,17,17,17,17,16,16,15,26,25,21,22,33,32,32,29,32,26,27,26,26,26,29,20,17,15,15,17,16,17,17,29,27,26,25,17,17,26,26,27,25,24,26,26,26,26,20,20,19,17,29,27,26,26,27,29,26,26,30,33,35,15,20,20,17,19,29,26,24,44,29,26,23,24,44,41,29,26,29,29,26,26],"text":["year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 2.8<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 25","year: 1999<br />displ: 2.8<br />hwy: 25","year: 1999<br />displ: 2.8<br />hwy: 25","year: 1999<br />displ: 2.8<br />hwy: 24","year: 1999<br />displ: 5.7<br />hwy: 17","year: 1999<br />displ: 5.7<br />hwy: 26","year: 1999<br />displ: 5.7<br />hwy: 23","year: 1999<br />displ: 5.7<br />hwy: 15","year: 1999<br />displ: 6.5<br />hwy: 17","year: 1999<br />displ: 2.4<br />hwy: 27","year: 1999<br />displ: 3.1<br />hwy: 26","year: 1999<br />displ: 2.4<br />hwy: 24","year: 1999<br />displ: 3.0<br />hwy: 24","year: 1999<br />displ: 3.3<br />hwy: 22","year: 1999<br />displ: 3.3<br />hwy: 22","year: 1999<br />displ: 3.8<br />hwy: 22","year: 1999<br />displ: 3.8<br />hwy: 21","year: 1999<br />displ: 3.9<br />hwy: 17","year: 1999<br />displ: 3.9<br />hwy: 17","year: 1999<br />displ: 5.2<br />hwy: 17","year: 1999<br />displ: 5.2<br />hwy: 15","year: 1999<br />displ: 3.9<br />hwy: 17","year: 1999<br />displ: 5.2<br />hwy: 16","year: 1999<br />displ: 5.9<br />hwy: 15","year: 1999<br />displ: 5.2<br />hwy: 15","year: 1999<br />displ: 5.2<br />hwy: 16","year: 1999<br />displ: 5.9<br />hwy: 15","year: 1999<br />displ: 4.6<br />hwy: 17","year: 1999<br />displ: 5.4<br />hwy: 17","year: 1999<br />displ: 4.0<br />hwy: 17","year: 1999<br />displ: 4.0<br />hwy: 19","year: 1999<br />displ: 4.0<br />hwy: 17","year: 1999<br />displ: 5.0<br />hwy: 17","year: 1999<br />displ: 4.2<br />hwy: 17","year: 1999<br />displ: 4.2<br />hwy: 17","year: 1999<br />displ: 4.6<br />hwy: 16","year: 1999<br />displ: 4.6<br />hwy: 16","year: 1999<br />displ: 5.4<br />hwy: 15","year: 1999<br />displ: 3.8<br />hwy: 26","year: 1999<br />displ: 3.8<br />hwy: 25","year: 1999<br />displ: 4.6<br />hwy: 21","year: 1999<br />displ: 4.6<br />hwy: 22","year: 1999<br />displ: 1.6<br />hwy: 33","year: 1999<br />displ: 1.6<br />hwy: 32","year: 1999<br />displ: 1.6<br />hwy: 32","year: 1999<br />displ: 1.6<br />hwy: 29","year: 1999<br />displ: 1.6<br />hwy: 32","year: 1999<br />displ: 2.4<br />hwy: 26","year: 1999<br />displ: 2.4<br />hwy: 27","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 4.0<br />hwy: 20","year: 1999<br />displ: 4.7<br />hwy: 17","year: 1999<br />displ: 4.0<br />hwy: 15","year: 1999<br />displ: 4.6<br />hwy: 15","year: 1999<br />displ: 5.4<br />hwy: 17","year: 1999<br />displ: 5.4<br />hwy: 16","year: 1999<br />displ: 4.0<br />hwy: 17","year: 1999<br />displ: 5.0<br />hwy: 17","year: 1999<br />displ: 2.4<br />hwy: 29","year: 1999<br />displ: 2.4<br />hwy: 27","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 3.0<br />hwy: 25","year: 1999<br />displ: 3.3<br />hwy: 17","year: 1999<br />displ: 3.3<br />hwy: 17","year: 1999<br />displ: 3.1<br />hwy: 26","year: 1999<br />displ: 3.8<br />hwy: 26","year: 1999<br />displ: 3.8<br />hwy: 27","year: 1999<br />displ: 2.5<br />hwy: 25","year: 1999<br />displ: 2.5<br />hwy: 24","year: 1999<br />displ: 2.2<br />hwy: 26","year: 1999<br />displ: 2.2<br />hwy: 26","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.5<br />hwy: 26","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 3.4<br />hwy: 19","year: 1999<br />displ: 3.4<br />hwy: 17","year: 1999<br />displ: 2.2<br />hwy: 29","year: 1999<br />displ: 2.2<br />hwy: 27","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 2.2<br />hwy: 27","year: 1999<br />displ: 2.2<br />hwy: 29","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 3.0<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 30","year: 1999<br />displ: 1.8<br />hwy: 33","year: 1999<br />displ: 1.8<br />hwy: 35","year: 1999<br />displ: 4.7<br />hwy: 15","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 2.7<br />hwy: 20","year: 1999<br />displ: 3.4<br />hwy: 17","year: 1999<br />displ: 3.4<br />hwy: 19","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 24","year: 1999<br />displ: 1.9<br />hwy: 44","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 23","year: 1999<br />displ: 2.8<br />hwy: 24","year: 1999<br />displ: 1.9<br />hwy: 44","year: 1999<br />displ: 1.9<br />hwy: 41","year: 1999<br />displ: 2.0<br />hwy: 29","year: 1999<br />displ: 2.0<br />hwy: 26","year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 1.8<br />hwy: 29","year: 1999<br />displ: 2.8<br />hwy: 26","year: 1999<br />displ: 2.8<br />hwy: 26"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"1999","legendgroup":"1999","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2,3.1,2,2,3.1,3.1,3.1,4.2,5.3,5.3,5.3,6,6.2,6.2,7,5.3,5.3,2.4,3.5,3.6,3.3,3.3,3.3,3.8,4,3.7,3.7,4.7,4.7,4.7,4.7,4.7,4.7,5.7,4.7,4.7,4.7,4.7,4.7,4.7,5.7,5.4,4,4.6,4.6,5.4,4,4,4.6,4.6,5.4,1.8,1.8,1.8,2,2.4,2.4,3.3,2,2,2.7,2.7,2.7,3,3.7,4.7,4.7,5.7,6.1,4.2,4.4,5.4,4,4.6,2.5,2.5,3.5,3.5,3.5,4,5.6,3.8,5.3,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,4,4.7,2.4,2.4,3.5,2.4,2.4,3.3,1.8,1.8,5.7,2.7,4,4,2,2,2,2,2.5,2.5,2.5,2.5,2,2,3.6],"y":[31,30,27,28,27,25,25,25,23,20,15,20,17,26,25,24,19,14,30,29,26,24,24,17,23,23,19,18,19,19,12,17,12,17,18,16,12,17,17,16,12,17,18,19,19,17,17,26,24,23,22,20,34,36,36,29,30,31,28,28,27,24,24,24,22,19,12,19,18,14,18,18,18,19,19,31,32,27,26,25,20,18,28,25,27,25,26,23,25,27,25,27,20,17,31,31,28,31,31,27,37,35,18,22,18,20,29,29,29,29,29,29,28,29,28,29,26],"text":["year: 2008<br />displ: 2.0<br />hwy: 31","year: 2008<br />displ: 2.0<br />hwy: 30","year: 2008<br />displ: 3.1<br />hwy: 27","year: 2008<br />displ: 2.0<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 27","year: 2008<br />displ: 3.1<br />hwy: 25","year: 2008<br />displ: 3.1<br />hwy: 25","year: 2008<br />displ: 3.1<br />hwy: 25","year: 2008<br />displ: 4.2<br />hwy: 23","year: 2008<br />displ: 5.3<br />hwy: 20","year: 2008<br />displ: 5.3<br />hwy: 15","year: 2008<br />displ: 5.3<br />hwy: 20","year: 2008<br />displ: 6.0<br />hwy: 17","year: 2008<br />displ: 6.2<br />hwy: 26","year: 2008<br />displ: 6.2<br />hwy: 25","year: 2008<br />displ: 7.0<br />hwy: 24","year: 2008<br />displ: 5.3<br />hwy: 19","year: 2008<br />displ: 5.3<br />hwy: 14","year: 2008<br />displ: 2.4<br />hwy: 30","year: 2008<br />displ: 3.5<br />hwy: 29","year: 2008<br />displ: 3.6<br />hwy: 26","year: 2008<br />displ: 3.3<br />hwy: 24","year: 2008<br />displ: 3.3<br />hwy: 24","year: 2008<br />displ: 3.3<br />hwy: 17","year: 2008<br />displ: 3.8<br />hwy: 23","year: 2008<br />displ: 4.0<br />hwy: 23","year: 2008<br />displ: 3.7<br />hwy: 19","year: 2008<br />displ: 3.7<br />hwy: 18","year: 2008<br />displ: 4.7<br />hwy: 19","year: 2008<br />displ: 4.7<br />hwy: 19","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 5.7<br />hwy: 18","year: 2008<br />displ: 4.7<br />hwy: 16","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 4.7<br />hwy: 16","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 5.7<br />hwy: 17","year: 2008<br />displ: 5.4<br />hwy: 18","year: 2008<br />displ: 4.0<br />hwy: 19","year: 2008<br />displ: 4.6<br />hwy: 19","year: 2008<br />displ: 4.6<br />hwy: 17","year: 2008<br />displ: 5.4<br />hwy: 17","year: 2008<br />displ: 4.0<br />hwy: 26","year: 2008<br />displ: 4.0<br />hwy: 24","year: 2008<br />displ: 4.6<br />hwy: 23","year: 2008<br />displ: 4.6<br />hwy: 22","year: 2008<br />displ: 5.4<br />hwy: 20","year: 2008<br />displ: 1.8<br />hwy: 34","year: 2008<br />displ: 1.8<br />hwy: 36","year: 2008<br />displ: 1.8<br />hwy: 36","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.4<br />hwy: 30","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 3.3<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 27","year: 2008<br />displ: 2.7<br />hwy: 24","year: 2008<br />displ: 2.7<br />hwy: 24","year: 2008<br />displ: 2.7<br />hwy: 24","year: 2008<br />displ: 3.0<br />hwy: 22","year: 2008<br />displ: 3.7<br />hwy: 19","year: 2008<br />displ: 4.7<br />hwy: 12","year: 2008<br />displ: 4.7<br />hwy: 19","year: 2008<br />displ: 5.7<br />hwy: 18","year: 2008<br />displ: 6.1<br />hwy: 14","year: 2008<br />displ: 4.2<br />hwy: 18","year: 2008<br />displ: 4.4<br />hwy: 18","year: 2008<br />displ: 5.4<br />hwy: 18","year: 2008<br />displ: 4.0<br />hwy: 19","year: 2008<br />displ: 4.6<br />hwy: 19","year: 2008<br />displ: 2.5<br />hwy: 31","year: 2008<br />displ: 2.5<br />hwy: 32","year: 2008<br />displ: 3.5<br />hwy: 27","year: 2008<br />displ: 3.5<br />hwy: 26","year: 2008<br />displ: 3.5<br />hwy: 25","year: 2008<br />displ: 4.0<br />hwy: 20","year: 2008<br />displ: 5.6<br />hwy: 18","year: 2008<br />displ: 3.8<br />hwy: 28","year: 2008<br />displ: 5.3<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 27","year: 2008<br />displ: 2.5<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 26","year: 2008<br />displ: 2.5<br />hwy: 23","year: 2008<br />displ: 2.5<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 27","year: 2008<br />displ: 2.5<br />hwy: 25","year: 2008<br />displ: 2.5<br />hwy: 27","year: 2008<br />displ: 4.0<br />hwy: 20","year: 2008<br />displ: 4.7<br />hwy: 17","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 3.5<br />hwy: 28","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 2.4<br />hwy: 31","year: 2008<br />displ: 3.3<br />hwy: 27","year: 2008<br />displ: 1.8<br />hwy: 37","year: 2008<br />displ: 1.8<br />hwy: 35","year: 2008<br />displ: 5.7<br />hwy: 18","year: 2008<br />displ: 2.7<br />hwy: 22","year: 2008<br />displ: 4.0<br />hwy: 18","year: 2008<br />displ: 4.0<br />hwy: 20","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 2.5<br />hwy: 29","year: 2008<br />displ: 2.5<br />hwy: 29","year: 2008<br />displ: 2.5<br />hwy: 28","year: 2008<br />displ: 2.5<br />hwy: 29","year: 2008<br />displ: 2.0<br />hwy: 28","year: 2008<br />displ: 2.0<br />hwy: 29","year: 2008<br />displ: 3.6<br />hwy: 26"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"2008","legendgroup":"2008","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.33,7.27],"tickmode":"array","ticktext":["2","3","4","5","6","7"],"tickvals":[2,3,4,5,6,7],"categoryorder":"array","categoryarray":["2","3","4","5","6","7"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"displ","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[10.4,45.6],"tickmode":"array","ticktext":["20","30","40"],"tickvals":[20,30,40],"categoryorder":"array","categoryarray":["20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"hwy","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"year","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c736797facf4":{"colour":{},"x":{},"y":{},"type":"scatter"}},"cur_data":"c736797facf4","visdat":{"c736797facf4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>You can now hover over a point to display more information about that point. There is also the possibility to zoom in and out, to download the plot, to select some observations, etc. More information about <code>{plotly}</code> for R can be found <a href="https://plotly.com/r/" target="_blank">here</a>.</p>
</div>
<div id="combine-plots-with-patchwork" class="section level3">
<h3>Combine plots with <code>{patchwork}</code></h3>
<p>There are several ways to combine plots made in <code>{ggplot2}</code>. In my opinion, the most convenient way is with the <code>{patchwork}</code> package using symbols such as <code>+</code>, <code>/</code> and parentheses.</p>
<p>We first need to create some plots and save them:</p>
<pre class="r"><code>p_a &lt;- ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_point()

p_b &lt;- ggplot(dat) +
  aes(x = hwy) +
  geom_histogram()

p_c &lt;- ggplot(dat) +
  aes(x = drv, y = hwy) +
  geom_boxplot()</code></pre>
<p>Now that we have 3 plots saved in our environment, we can combine them. To have plots <strong>next to each other</strong> simply use the <code>+</code> symbol:</p>
<pre class="r"><code>library(patchwork)
p_a + p_b + p_c</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-51-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>To display them <strong>above each other</strong> simply use the <code>/</code> symbol:</p>
<pre class="r"><code>p_a / p_b / p_c</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-52-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>And finally, to combine them <strong>above and next</strong> to each other, mix <code>+</code>, <code>/</code> and parentheses:</p>
<pre class="r"><code>p_a + p_b / p_c</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-53-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>(p_a + p_b) / p_c</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-53-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>See more ways to combine plots with:</p>
<ul>
<li><code>grid.arrange()</code> from the <code>{gridExtra}</code> package</li>
<li><code>plot_grid()</code> from the <code>{cowplot}</code> package</li>
</ul>
</div>
<div id="flip-coordinates" class="section level3">
<h3>Flip coordinates</h3>
<p>Flipping coordinates of your plot is useful to create horizontal boxplots, or when labels of a variable are so long that they overlap each other on the x-axis. See with and without flipping coordinates below:</p>
<pre class="r"><code># without flipping coordinates
p1 &lt;- ggplot(dat) +
  aes(x = class, y = hwy) +
  geom_boxplot()

# with flipping coordinates
p2 &lt;- ggplot(dat) +
  aes(x = class, y = hwy) +
  geom_boxplot() +
  coord_flip()

library(patchwork)
p1 + p2 # left: without flipping, right: with flipping</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-54-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>This can be done with many types of plot, not only with boxplots. For instance, if a categorical variable has many levels or the labels are long, it is usually best to flip the coordinates for a better visual:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = class) +
  geom_bar() +
  coord_flip()</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-55-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="save-plot" class="section level3">
<h3>Save plot</h3>
<p>The <code>ggsave()</code> function will save the most recent plot in your current <a href="/blog/how-to-import-an-excel-file-in-rstudio/#r-working-directory">working directory</a> unless you specify a path to another folder:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = displ, y = hwy) +
  geom_point()

ggsave(&quot;plot1.pdf&quot;)</code></pre>
<p>You can also specify the width, height and resolution (<code>dpi</code>) as follows:</p>
<pre class="r"><code>ggsave(&quot;plot1.pdf&quot;,
  width = 12,
  height = 12,
  units = &quot;cm&quot;,
  dpi = 300
)</code></pre>
</div>
<div id="managing-dates" class="section level3">
<h3>Managing dates</h3>
<p>If the time variable in your dataset is in date format, the <code>{ggplot2}</code> package recognizes the date format and automatically uses a specific type for the axis ticks.</p>
<p>There is no time variable with a date format in our dataset, so let’s create a new variable of this type thanks to the <code>as.Date()</code> function:</p>
<pre class="r"><code>dat$date &lt;- as.Date(&quot;2020-08-21&quot;) - 0:(nrow(dat) - 1)</code></pre>
<p>See the first 6 observations of this date variable and its class:</p>
<pre class="r"><code>head(dat$date)</code></pre>
<pre><code>## [1] &quot;2020-08-21&quot; &quot;2020-08-20&quot; &quot;2020-08-19&quot; &quot;2020-08-18&quot; &quot;2020-08-17&quot;
## [6] &quot;2020-08-16&quot;</code></pre>
<pre class="r"><code>str(dat$date)</code></pre>
<pre><code>##  Date[1:234], format: &quot;2020-08-21&quot; &quot;2020-08-20&quot; &quot;2020-08-19&quot; &quot;2020-08-18&quot; &quot;2020-08-17&quot; ...</code></pre>
<p>The new variable <code>date</code> is correctly specified in a date format.</p>
<p>Most of the time, with a time variable, we want to create a line plot with the date on the X-axis and another continuous variable on the Y-axis, like the following plot for example:</p>
<pre class="r"><code>p &lt;- ggplot(dat) +
  aes(x = date, y = hwy) +
  geom_line()
p</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-60-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>As soon as the time variable is recognized as a date, we can use the <code>scale_x_date()</code> layer to change the format displayed on the X-axis. The following table shows the most frequent date formats:</p>
<div class="figure">
<img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/date%20formats%20in%20R.png" alt="" />
<p class="caption">Source: www.statmethods.net</p>
</div>
<p>Run <code>?strptime()</code> to see many more date formats available in R.</p>
<p>For this example, let’s add the year in addition to the unabbreviated month:</p>
<pre class="r"><code>p + scale_x_date(date_labels = &quot;%B %Y&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-61-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>It also possible to control the breaks to display on the X-axis with the <code>date_breaks</code> argument. For this example, let’s say we want to display the day as number and the abbreviated month for each interval of 10 days:</p>
<pre class="r"><code>p + scale_x_date(date_breaks = &quot;10 days&quot;, date_labels = &quot;%d %b&quot;)</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-62-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>If labels displayed on the X-axis are unreadable because they overlap each other, you can rotate them with the <code>theme()</code> layer and the <code>angle</code> argument:</p>
<pre class="r"><code>p + scale_x_date(date_breaks = &quot;10 days&quot;, date_labels = &quot;%d %b&quot;) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-63-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="tip" class="section level1">
<h1>Tip</h1>
<p>I recently learned a tip very useful when drawing plots with <code>{ggplot2}</code>. If like me, you often comment and uncomment some lines of code in your plot, you know that you cannot transform the last line into a comment without removing the <code>+</code> sign in the line just above.</p>
<p>Adding a line <code>NULL</code> at the end of your plots will avoid an error if you forget to remove the <code>+</code> sign in the last line of your code. See with this basic example:</p>
<pre class="r"><code>ggplot(dat) +
  aes(x = date, y = hwy) +
  geom_line() + # I do not have to remove the + sign
  # theme_minimal() + # this line is a comment
  NULL # adding this line doesn&#39;t change anything to the plot</code></pre>
<p><img src="/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-64-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>This trick saves me a lot of time as I do not need to worry about making sure to remove the last <code>+</code> sign after commenting some lines of code in my plots.</p>
<p>If you find this trick useful, you may like these other <a href="/blog/tips-and-tricks-in-rstudio-and-r-markdown/">tips and tricks in RStudio and R Markdown</a>.</p>
</div>
<div id="to-go-further" class="section level1">
<h1>To go further</h1>
<p>By now you have seen that <code>{ggplot2}</code> is a very powerful and complete package to create plots in R. This article illustrated only the tip of the iceberg, and you will find many tutorials on how to create more advanced plots and visualizations with <code>{ggplot2}</code> online. If you want to learn more than what is described in the present article, I highly recommend starting with:</p>
<ul>
<li>the chapters <a href="https://r4ds.had.co.nz/data-visualisation.html" target="_blank">Data visualisation</a> and <a href="https://r4ds.had.co.nz/graphics-for-communication.html" target="_blank">Graphics for communication</a> from the book <a href="https://r4ds.had.co.nz/" target="_blank">R for Data Science</a> from Garrett Grolemund and Hadley Wickham</li>
<li>the book <a href="https://ggplot2-book.org/" target="_blank">ggplot2: Elegant Graphics for Data Analysis</a> from Hadley Wickham</li>
<li>the book <a href="https://r-graphics.org/" target="_blank">R Graphics Cookbook</a> from Winston Chang</li>
<li>the <a href="https://exts.ggplot2.tidyverse.org/gallery/" target="_blank">ggplot2 extensions guide</a> which lists many of the packages that extend <code>{ggplot2}</code></li>
<li>the <a href="/blog/files/ggplot2-cheatsheet.pdf"><code>{ggplot2}</code> cheat sheet</a></li>
</ul>
<p>Thanks for reading. I hope this article helped you to create your first plots with the <code>{ggplot2}</code> package. As a reminder, for simple graphs, it is sometimes easier to draw them via the <a href="/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/#esquisse">{esquisse} addin</a>. After some time, you will quickly learn how to create them by yourselves and in no time you will be able to build complex and sophisticated data visualizations.</p>
<p>As always, if you have a question or a suggestion related to the topic covered in this article, please add it as a comment so other readers can benefit from the discussion.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Use the <code>geom_jitter()</code> layer with caution because, although it makes a plot more revealing at large scales, it also makes it slightly less accurate at small scales since some randomness is added to the points.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>There are (at the time of writing) 26 shapes accepted in the <code>shape</code> argument. See this <a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html" target="_blank">documentation</a> for all available shapes.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
