---
title: Descriptive statistics in R
author: Antoine Soetewey
date: '2020-01-22'
slug: descriptive-statistics-in-r
categories: []
tags:
  - R
  - Statistics
meta_img: image/image.png
# description: Description for the page.
output:
  blogdown::html_page:
    toc: true
draft: true
---

# Introduction

This article explains how to compute the main descriptive statistics in R and how to present them graphically. To learn more about the reasoning behind each descriptive statistics and learn how to compute them by hand, read the article "[Descriptive statistics by hand](/blog/descriptive-statistics-by-hand/)".

To briefly recap what have been said in that article, descriptive statistics (in the broad sense of the term) is a branch of statistics aiming at summarizing, describing and presenting a series of values or a dataset. Descriptive statistics is often the first step and an important part in any statistical analysis. It allows to check the quality of the data and it helps to "understand" the data by having a clear overview of it. If well presented, descriptive statistics is already a good starting point for further analyses. There exists many measures to summarize a dataset. They are divided into two types: (i) location and (ii) dispersion measures. Location measures give an understanding about the central tendency of the data, whereas dispersion measures give an understanding about the spread of the data. In this article, we focus only on the implementation in R of the most common descriptive statistics and their visualizations (when deemed appropriate). See online or in the [above mentioned article](/blog/descriptive-statistics-by-hand/) for more information about the purpose and usage of each measure.

# Data

We use the dataset `iris` through the article. This dataset is imported by default in R, you only need to load it by running `iris`:

```{r}
dat <- iris # load the iris dataset and renamed it dat
```

Below a preview of this dataset and its structure:

```{r}
head(dat) # first 6 observations
str(dat) # structure of dataset
```

The dataset contains 150 observations and 5 variables, representing the length and width of the sepal and petal and the species of 150 flowers. Length and width of the sepal and petal are numeric variables and the species is a factor with 3 levels (indicated by `num` and `Factor w/ 3 levels` after the name of the variables). See the [different variables types in R](/blog/data-types-in-r) if you need a refresh.

For plots, we use the default graphs and the graphs from the package `{ggplot2}`. Graphs from `{ggplot2}` have a better look but it requires more advanced code so if you need to publish or share your graphs, I suggest using `{ggplot2}`, otherwise the default graphics will do the job.

# Minimum and maximum

```{r}
min(dat$Sepal.Length)
max(dat$Sepal.Length)
```

Alternatively:

```{r}
range(dat$Sepal.Length)
```

gives you the minimum and maximum directly.

# Mean

```{r}
mean(dat$Sepal.Length)
```

*Tips:*

* if there is at least one missing value in your dataset, use `mean(dat$Sepal.Length, na.rm = TRUE)` to compute the mean without the NA. This argument can be used for many functions, not only the mean
* for a truncated mean, use `mean(dat$Sepal.Length, trim = 0.10)` and change the `trim` argument to your needs

# Median

```{r}
median(dat$Sepal.Length)
```

or:

```{r}
quantile(dat$Sepal.Length, 0.5)
```

# First and third quartile

```{r}
quantile(dat$Sepal.Length, 0.25) # first quartile
quantile(dat$Sepal.Length, 0.75) # third quartile
```

## Other quantiles

As you have guessed, any quantile can also be computed with the `quantile()` function. For instance, the $4^{th}$ decile or the $98^{th}$ percentile:

```{r}
quantile(dat$Sepal.Length, 0.4) # 4th decile
quantile(dat$Sepal.Length, 0.98) # 98th percentile
```

# Standard deviation and variance

```{r}
sd(dat$Sepal.Length) # standard deviation
var(dat$Sepal.Length) # variance
```

Remember from this [article](/blog/descriptive-statistics-by-hand/) that the standard deviation and the variance are different whether we compute it for a sample or a population (see the difference between the two [here](/blog/what-is-the-difference-between-population-and-sample/)). In R, the standard deviation and the variance are computed as if the data represent a sample (so the denominator is $n - 1$, where $n$ is the number of observations). To my knowledge, there is no function by default in R that computes the standard deviation and variance for a population.

*Tip:* to compute the standard deviation (or variance) of multiple variables at the same time, use:

```{r}
lapply(dat[, 1:4], sd) # dat[, 1:4] selects the variables 1 to 4
```

# Interquartile range

```{r}
IQR(dat$Sepal.Length)
```

`IQR()` actually computes:

```{r}
quantile(dat$Sepal.Length, 0.75) - quantile(dat$Sepal.Length, 0.25)
```

# Summary

You can compute the minimum, $1^{st}$ quartile, median, mean, $3^{rd}$ quartile and the maximum for all variables of the dataset at once using `summary()`:

```{r}
summary(dat)
```

*Tip:* if you need these descriptive statistics by group:

```{r}
by(dat, dat$Species, summary)
```

where the arguments are the name of the dataset, the grouping variable and the summary function (in this order).

If you need more descriptive statistics, use `stat.desc()` from the package `{pastecs}`:

```{r}
library(pastecs)
stat.desc(dat, norm = TRUE)
```

Note that the variable `Species` is not numeric, so descriptive statistics cannot be computed for this variable and NA are displayed.

# Coefficient of variation

The coefficient of variation can be found with `stat.desc()` (see the line `coef.var` in the table above) or by computing manually (remember that the coefficient of variation is the standard deviation divided by the mean):

```{r}
sd(dat$Sepal.Length) / mean(dat$Sepal.Length)
```

# Mode

To my knowledge there is no function to find the mode of a variable. However, we can easily find it thanks to the functions `table()` and `sort()`:

```{r}
tab <- table(dat$Sepal.Length) # number of occurences for each unique value
sort(tab, decreasing = TRUE) # sort highest to lowest
```

`table()` gives the number of occurences for each unique value, then `sort()` with the argument `decreasing = TRUE` displays the number of occurences from highest to lowest. The mode of the variable `Sepal.Length` is thus 5. This code to find the mode can also be applied to qualitative variables such as `Species`:

```{r}
sort(table(dat$Species), decreasing = TRUE)
```

or:

```{r}
summary(dat$Species)
```

# Barplot

Barplots can only be done on qualitative variables (see the difference with a quantative variable [here](/blog/variable-types-and-examples/)). The only qualitative variable in the dataset is the variable `Species`:

```{r}
barplot(table(dat$Species)) # table() is mandatory
```

All bars have the same height as there are 50 observations of each species.

In `{ggplot2}`:

```{r}
library(ggplot2)

ggplot(dat) +
 aes(x = Species) +
 geom_bar()
```

Both plots can be customized. For instance, it is possible to edit the title, x and y-axis labels, color, etc. However, customizing plots is beyond the scope of this article so all plots in this article are presented without any customization. Interested readers will find numerous resources online.

# Histogram



# Boxplot



